<div class="popup-overlay">
  <div class="popup-card">
    <div class="text-center">
      <div class="image-header mb-3 ">
        <img src="Images/logo.png" alt="Header" class="header-img" />
      </div>
      <h3 class=" text-success">اضافة مستشار جديد</h3>
    </div>


    <form [formGroup]="consultantForm" (ngSubmit)="onSubmit()">
      <!-- Profile Image Upload -->
      <div class="form-group text-center">
        <label class="fw-bold mb-2">صورة المستشار</label>
        <input type="file" accept="image/*" class="form-control mb-2" (change)="onImageChange($event)" />

        @if (uploadedImageUrl) {
        <img [src]="uploadedImageUrl" alt="صورة المستشار" class="img-thumbnail rounded shadow mt-2" width="150" />
        }

        @if (consultantForm.get('profileImage')?.touched && consultantForm.get('profileImage')?.invalid) {
        <span class="text-danger small">يرجى تحميل صورة المستشار</span>
        }
      </div>

      <!-- Full Name -->
      <div class="form-group">
        <label for="fullName">الاسم الكامل</label>
        <input type="text" id="fullName" formControlName="fullName" class="form-control" placeholder="الاسم الكامل" />
        @if (consultantForm.get('fullName')?.touched && consultantForm.get('fullName')?.invalid) {
        <span class="text-danger small">الاسم الكامل مطلوب ولا يزيد عن 50 حرفًا</span>
        }
      </div>

      <!-- Email & Phone -->
      <div class="row">
        <div class="col-md-6 form-group">
          <label for="email">البريد الإلكتروني</label>
          <input type="email" id="email" formControlName="email" class="form-control" placeholder="Houda42@gmail.com" />
          @if (consultantForm.get('email')?.touched && consultantForm.get('email')?.invalid) {
          <span class="text-danger small">يرجى إدخال بريد إلكتروني صحيح</span>
          }
        </div>
  <div class="col-md-6 form-group">
  <label for="phoneNumber">رقم الهاتف</label>
  <div class="d-flex align-items-stretch gap-2">
    <select formControlName="countryCode" class="form-select country-code-select">
      <option value="+20">20+</option>
      <option value="+966">966+</option>
      <option value="+971">971+</option>
      <option value="+965">965+</option>
      <option value="+1">1+</option>
    </select>

    <input
      type="text"
      id="phoneNumber"
      formControlName="phoneNumber"
      class="form-control flex-grow-1 text-start"
      placeholder="رقم الهاتف"
    />
  </div>

  @if (
    (consultantForm.get('phoneNumber')?.touched && consultantForm.get('phoneNumber')?.invalid) ||
    (consultantForm.get('countryCode')?.touched && consultantForm.get('countryCode')?.invalid)
  ) {
    <span class="text-danger small">رقم الهاتف مع كود الدولة مطلوب ولا يزيد عن 20 رقمًا</span>
  }
</div>


      </div>

      <!-- Specialty -->
      <div class="form-group">
        <label for="specialty">الشهادة العلمية</label>
        <input type="text" id="specialty" formControlName="specialty" class="form-control" placeholder="الشهادة العلمية" />
        @if (consultantForm.get('specialty')?.touched && consultantForm.get('specialty')?.invalid) {
        <span class="text-danger small">االشهادة العلمية مطلوب ولا يزيد عن 100 حرف</span>
        }
      </div>
      <!-- Consultation -->
      <div class="form-group">
        <label for="consultation">نوع الأستشارة</label>
        <select id="consultation" class="form-control" formControlName="consultation">
          <option value="">اختر نوع الاستشارة</option>
          @for (type of consultationTypes; track type.id) {
          <option [value]="type.id">{{ type.consultationName }}</option>
          }
        </select>

        @if (consultantForm.get('consultation')?.touched && consultantForm.get('consultation')?.invalid) {
        <span class="text-danger small">المجال مطلوب ولا يزيد عن 100 حرف</span>
        }
      </div>

      <!-- Description -->
      <div class="form-group">
        <label for="description">الوصف</label>
        <textarea id="description" formControlName="description" class="form-control"
          placeholder="أدخل وصفًا مختصرًا"></textarea>
        @if (consultantForm.get('description')?.touched && consultantForm.get('description')?.invalid) {
        <span class="text-danger small">الوصف مطلوب ولا يزيد عن 1000 حرف</span>
        }
      </div>

      <!-- Zoom URL -->
      <div class="form-group">
        <label for="zoomUrl">رابط Zoom</label>
        <input type="url" id="zoomUrl" formControlName="zoomUrl" class="form-control"
          placeholder="https://zoom.us/your-link" />
        @if (consultantForm.get('zoomUrl')?.touched && consultantForm.get('zoomUrl')?.invalid) {
        <span class="text-danger small">رابط Zoom مطلوب</span>
        }
      </div>

      <!-- Password -->
      <div class="form-group password-group">
        <label for="password">رمز المرور</label>
        <div class="input-wrapper left-icon">
          <i class="bi toggle-icon" [class.bi-eye]="!showPassword" [class.bi-eye-slash]="showPassword"
            (click)="togglePasswordVisibility('password')"></i>
          <input [type]="showPassword ? 'text' : 'password'" id="password" formControlName="password"
            class="form-control" placeholder="********" />
        </div>
        @if (consultantForm.get('password')?.touched && consultantForm.get('password')?.invalid) {
        <span class="text-danger small">
          كلمة المرور مطلوبة وتحتوي على 6 أرقام على الأقل
        </span>
        }
      </div>

      <!-- Confirm Password -->
      <div class="form-group password-group">
        <label for="confirmPassword">تأكيد رمز المرور</label>
        <div class="input-wrapper left-icon">
          <i class="bi toggle-icon" [class.bi-eye]="!showConfirmPassword" [class.bi-eye-slash]="showConfirmPassword"
            (click)="togglePasswordVisibility('confirm')"></i>
          <input [type]="showConfirmPassword ? 'text' : 'password'" id="confirmPassword"
            formControlName="confirmPassword" class="form-control" placeholder="********" />
        </div>
        @if (consultantForm.get('confirmPassword')?.touched && consultantForm.get('confirmPassword')?.invalid) {
        <span class="text-danger small">تأكيد رمز المرور مطلوب</span>
        }
        @if (consultantForm.hasError('mismatch') && consultantForm.get('confirmPassword')?.touched) {
        <span class="text-danger small">رمز المرور وتأكيده غير متطابقين</span>
        }
      </div>

      <!-- Submit / Cancel -->
      <button type="submit" class="btn w-100 mt-3 register-btn">سجل المستشار</button>
      <button type="button" class="btn btn-outlet w-100 mt-2" (click)="onCancel()">إلغاء</button>
    </form>
  </div>
</div>