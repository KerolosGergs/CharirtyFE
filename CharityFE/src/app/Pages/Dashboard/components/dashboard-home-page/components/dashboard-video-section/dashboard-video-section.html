<div class="card shadow animate__animated animate__fadeIn">
  <div class="card-header bg-success text-white d-flex align-items-center fs-5">
    <i class="bi bi-play-circle-fill ms-2 fs-4"></i>
    <h5 class="mb-0 fw-bold fs-4">إدارة قسم الفيديو</h5>
  </div>

  <div class="card-body">
    @if (!loading) {
    <div class="row g-4">
      <!-- Form -->
      <div class="col-lg-6">
        <form #videoForm="ngForm" (ngSubmit)="updateVideoSection()" class="p-2">

          <div class="mb-3 form-group">
            <label class="form-label fw-semibold fs-6">عنوان الفيديو</label>
            <input type="text" class="form-control form-control-lg" [(ngModel)]="videoData.Title" name="title" required
              #title="ngModel">
            @if (title.touched && title.invalid) {
            <span class="text-danger small">عنوان الفيديو مطلوب</span>
            }
          </div>

          <div class="mb-3 form-group">
            <label class="form-label fw-semibold fs-6">وصف الفيديو</label>
            <textarea class="form-control form-control-lg" rows="4" [(ngModel)]="videoData.Description"
              name="description" required #description="ngModel">
              </textarea>
            @if (description.touched && description.invalid) {
            <span class="text-danger small">وصف الفيديو مطلوب</span>
            }
          </div>

          <div class="mb-4 form-group">
            <label class="form-label fw-semibold fs-6">رابط الفيديو</label>
            <input type="url" class="form-control form-control-lg" [(ngModel)]="videoData.VideoUrl" name="videoUrl"
              required #videoUrl="ngModel" placeholder="https://example.com/video.mp4">
            @if (videoUrl.touched && videoUrl.invalid) {
            <span class="text-danger small">رابط الفيديو مطلوب ويجب أن يكون صحيحاً</span>
            }
          </div>

          <div class="d-grid">
            <button type="submit" class="btn btn-lg btn-success" [disabled]="videoForm.invalid || updating">
              @if (updating) {
              <span class="spinner-border spinner-border-sm ms-2"></span> جاري الحفظ...
              } @else {
              <i class="bi bi-check-circle ms-2"></i> حفظ التغييرات
              }
            </button>
          </div>

        </form>
      </div>

      <!-- Preview -->
      <div class="col-lg-6">
        <div class="card bg-light">
          <div class="card-body p-4">
            <h6 class="card-title text-muted fw-bold fs-5">معاينة قسم الفيديو</h6>
            <div class="video-preview text-center">
              <div class="ratio ratio-16x9">
                @if (videoData.VideoUrl) {
                  <iframe [src]="IvideoUrl" frameborder="0" allowfullscreen allow="autoplay; encrypted-media" class="rounded shadow-sm border"></iframe>
                <!-- <iframe [src]="'https://www.youtube.com/embed/' + extractYouTubeId(videoData.VideoUrl)"
                  title="YouTube video" allowfullscreen class="rounded shadow-sm border"></iframe> -->
                } @else {
                <div class="video-placeholder p-5">
                  <i class="bi bi-play-circle display-1 text-success"></i>
                </div>
                }
              </div>

              <div class="video-info mt-3">
                <h5 class="text-dark fs-4">{{ videoData.Title || 'عنوان الفيديو' }}</h5>
                <p class="text-muted fs-5">{{ videoData.Description || 'وصف الفيديو سيظهر هنا' }}</p>
                <small class="text-success fs-5">
                  <i class="bi bi-link-45deg"></i>
                  {{ videoData.VideoUrl || 'رابط الفيديو' }}
                </small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    } @else {
    <div class="text-center py-5">
      <div class="spinner-border text-success" role="status">
        <span class="visually-hidden">جاري التحميل...</span>
      </div>
      <p class="mt-3 text-muted fs-5">جاري تحميل البيانات...</p>
    </div>
    }

    @if (successMessage) {
    <div class="alert alert-success mt-4 animate__animated animate__fadeIn">
      <i class="bi bi-check-circle-fill me-2"></i> {{ successMessage }}
    </div>
    }

    @if (errorMessage) {
    <div class="alert alert-danger mt-4 animate__animated animate__fadeIn">
      <i class="bi bi-exclamation-circle-fill me-2"></i> {{ errorMessage }}
    </div>
    }
  </div>
</div>