<app-header-component></app-header-component>
<app-nav></app-nav>

@defer {
  <app-header-component-consultant
    title="نسعى للصلح... لننعم جميعًا بالأمان والسكينة"
    description="في سعينا لبناء مجتمع مطمئن ومتآلف، نعمل على إصلاح ذات البين وحل النزاعات الأسرية والاجتماعية بروح المحبة والحكمة."
    ImgUrl="RequestRapair.jpg"
    ></app-header-component-consultant>

  <div class="help-container animate__animated animate__fadeInUp">
    <div class="page-header text-center mb-4">
      <h2 class="page-title">طلب إصلاح</h2>
    </div>

    <div class="row g-4">
      <div class="col-lg-6 animate__animated animate__fadeInRight">
        <div class="bg-white p-4 rounded-3 shadow-sm">
          <div class="text-center mb-4">
            <h3 class="text-dark">{{ formSection.title }}</h3>
          </div>

          <form [formGroup]="contactForm" (ngSubmit)="onSubmit()">
            @for (field of formFields; track $index) {
              <div class="form-group mb-3" >
                <label [for]="field.id">{{ field.label }}</label>
                <div class="position-relative">
                  <input
                    class="form-control pe-5"
                    [id]="field.id"
                    [type]="field.type"
                    [placeholder]="field.placeholder"
                    [formControlName]="field.id"
                  />
                  <i
                    class="bi input-icon position-absolute top-50 end-0 translate-middle-y pe-3 text-muted"
                    [ngClass]="field.iconClass"
                  ></i>
                </div>
                @if(hasError(field.id))
                {
                  <span class="text-danger small">{{ getErrorMessage(field.id) }}</span>

                }
              </div>

            }

            <div class="form-group mb-3">
              <label [for]="messageField.id">{{ messageField.label }}</label>
              <textarea
                class="form-control"
                [id]="messageField.id"
                [placeholder]="messageField.placeholder"
                formControlName="message"
                [maxlength]="messageField.maxLength"
                rows="4"
              ></textarea>
              <div class="d-flex justify-content-between mt-1">
                @if(hasError('message')){

                  <span class="text-danger small" >{{ getErrorMessage('message') }}</span>
                }
                <small class="text-muted">{{ messageCharacterCount }}/{{ messageField.maxLength }}</small>
              </div>
            </div>

            <div class="d-grid">
              <button type="submit" class="btn btn-success btn-lg" [disabled]="contactForm.invalid">
                <i class="bi bi-send-fill me-2"></i>{{ submitButton.text }}
              </button>
            </div>
          </form>
        </div>
      </div>

      <div class="col-lg-6 animate__animated animate__fadeInLeft my-auto">
        <div class="bg-white p-4 rounded-3 shadow-sm">
          <app-contact-info></app-contact-info>
        </div>
      </div>
    </div>
  </div>
}

@placeholder {
  <app-spinner></app-spinner>
}

<app-footer></app-footer>
