<div class="availability-manager-container">
  <h2 class="section-title">إدارة المواعيد المتاحة</h2>

  <div class="calendar-section mb-4">
    <label class="form-label">اختر اليوم</label>
    @defer (on idle) {
<mat-calendar 
      [startAt]="initialDate"
      (selectedChange)="onDateChange($event)"
      [dateFilter]="dateFilter"
      [selected]="selectedDate"
      class="custom-calendar">
    </mat-calendar>
    }
    
  </div>

  @if (allHours.length > 0) {
    <div class="hours-section mb-4">
      <label class="form-label">المواعيد المتاحة:</label>
      <div class="hours-list d-flex flex-wrap gap-3">
        @for (hour of allHours; track hour) {
          <span 
            class="badge px-3 py-2"
            [ngClass]="{
              'bg-primary text-white': selectedTimeId === hour.id, 
              'bg-light text-dark': selectedTimeId !== hour.id
            }"
            (click)="selectTime(hour.id)">
            {{ hour.time }}
          </span>
        
      
    
   
}
</div>
@if (selectedTimeLabel) {
  <div class="mt-3 text-success fs-5 fw-bold animate__animated animate__fadeIn">
    الوقت المختار: {{ selectedTimeLabel }}
  </div>
}
    
  </div>
  }
  <!-- <button class="save-btn btn btn-primary" (click)="saveAvailability()">حجز الموعد</button> -->

  @if (saveSuccess) {
    <div class="alert alert-success mt-3">تم الحجز بنجاح!</div>
  }

  @if (saveError) {
    <div class="alert alert-danger mt-3">{{ saveError }}</div>
  }

  @if (error) {
    <div class="alert alert-danger mt-3">{{ error }}</div>
  }

  @if (isLoading) {
    <div class="spinner-border text-primary mt-3" role="status">
      <span class="visually-hidden">جاري التحميل...</span>
    </div>
  }
</div>
